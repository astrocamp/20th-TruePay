{% extends 'merchant_layout/dashboard_base.html' %}
  {% load static %}

  {% block title %}自訂網域管理{% endblock %}

  {% block content %}
  <div class="max-w-6xl mx-auto p-6 space-y-6">
      <!-- 頁面標題 -->
      <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6">
          <div class="flex flex-col md:flex-row md:justify-between md:items-center gap-4">
              <div>
                  <h1 class="text-2xl font-bold text-gray-900">自訂網域管理</h1>
                  <p class="text-gray-600 mt-1">使用您自己的網域名稱來展示商店</p>
              </div>
              <div class="text-sm text-gray-500">
                  <span>目前商店網址：</span>
                  <code class="bg-gray-100 px-2 py-1 rounded">{{ merchant.subdomain}}.truepay.com</code>
              </div>
          </div>
      </div>

      <!-- 新增網域表單 -->
      <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6">
          <h2 class="text-lg font-semibold text-gray-900 mb-4">新增自訂網域</h2>
          <form method="post" action="{% url 'merchant_account:own_domain_add' merchant.subdomain %}" class="space-y-4">
              {% csrf_token %}
              <div class="flex flex-col md:flex-row gap-4">
                  <div class="flex-1">
                      {{ form.domain_name }}
                  </div>
                  <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-medium transition-colors duration-200 flex items-center gap-2">
                      {% include 'components/icons.html' with icon='plus' %}
                      新增網域
                  </button>
              </div>
              <p class="text-sm text-gray-600">
                  請輸入您擁有的網域名稱，例如：www.myshop.com 或 shop.mydomain.com
              </p>
          </form>
      </div>

      <!-- 網域列表 -->
      <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6">
          <h2 class="text-lg font-semibold text-gray-900 mb-4">已設定的自訂網域</h2>

          {% if domains %}
              <div class="space-y-4">
                  {% for domain in domains %}
                  <div class="border border-gray-200 rounded-xl p-4 hover:shadow-md transition-shadow duration-200">
                      <div class="flex flex-col md:flex-row md:justify-between md:items-center gap-4">
                          <div class="flex-1">
                              <div class="flex items-center gap-3">
                                  <code class="bg-gray-100 px-3 py-1 rounded-lg text-sm font-mono">
                                      {{ domain.domain_name }}
                                  </code>

                                  {% if domain.is_verified %}
                                      <span class="inline-flex items-center gap-1 bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-medium">
                                          {% include 'components/icons.html' with icon='check-circle' %}
                                          已驗證
                                      </span>
                                  {% else %}
                                      <span class="inline-flex items-center gap-1 bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full text-xs font-medium">
                                          {% include 'components/icons.html' with icon='exclamation-triangle' %}
                                          待驗證
                                      </span>
                                  {% endif %}

                                  {% if domain.ssl_enabled %}
                                      <span class="inline-flex items-center gap-1 bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium">
                                          {% include 'components/icons.html' with icon='shield-check'%}
                                          SSL
                                      </span>
                                  {% endif %}
                              </div>
                              <div class="mt-2 text-sm text-gray-600">
                                  新增時間：{{ domain.created_at|date:"Y-m-d H:i" }}
                                  {% if domain.verified_at %}
                                      | 驗證時間：{{ domain.verified_at|date:"Y-m-d H:i" }}
                                  {% endif %}
                              </div>
                          </div>

                          <div class="flex items-center gap-2">
                            {% if domain.is_verified %}
                                <a href="https://{{ domain.domain_name }}" target="_blank"
                                    class="bg-blue-100 hover:bg-blue-200 text-blue-700 px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 flex items-center gap-1">
                                    {% include 'components/icons.html' with icon='external-link' %}
                                    訪問商店
                                </a>
                            {% endif %}
                                <a href="{% url 'merchant_account:own_domain_detail' merchant.subdomain domain.pk %}"
                                    class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium transition-colors duration-200 flex items-center gap-1">
                                    {% include 'components/icons.html' with icon='cog' %}
                                    管理
                                </a>
                          </div>
                      </div>
                  </div>
                  {% endfor %}
              </div>
          {% else %}
              <div class="text-center py-12">
                  <div class="text-gray-400 mb-4">
                      {% include 'components/icons.html' with icon='globe' %}
                  </div>
                  <p class="text-gray-600 text-lg">尚未設定任何自訂網域</p>
                  <p class="text-gray-500 text-sm mt-2">
                      新增您的自訂網域，讓客戶可以透過您的網址訪問商店
                  </p>
              </div>
          {% endif %}
      </div>
  </div>
  {% endblock %}