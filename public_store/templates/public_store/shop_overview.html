{% extends "layouts/default.html" %}
{% block title %}{{ merchant.ShopName }} - 商品總覽{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
  <div class="max-w-6xl mx-auto">
    
    <!-- 商家資訊區塊 -->
    <div class="bg-white rounded-lg shadow-lg overflow-hidden mb-8">
      <div class="p-8 bg-gray-50 border-b border-gray-200">
        <div class="flex items-center space-x-6">
          <div class="bg-[#0056B3] text-white w-16 h-16 rounded-full flex items-center justify-center font-bold text-2xl">
            {{ merchant.ShopName|first }}
          </div>
          <div>
            <h1 class="text-4xl font-bold text-gray-800 mb-2">{{ merchant.ShopName }}</h1>
            <p class="text-gray-600">{{ merchant.Address }}</p>
          </div>
        </div>
        
        <div class="mt-6 grid md:grid-cols-3 gap-4">
          <div class="flex items-center">
            {% include 'components/icons.html' with icon='contact-person' class='w-5 h-5 mr-3 text-[#0056B3]' %}
            <div>
              <span class="text-gray-600 text-sm">聯絡人</span>
              <p class="text-gray-800 font-medium">{{ merchant.Name }}</p>
            </div>
          </div>
          
          <div class="flex items-center">
            {% include 'components/icons.html' with icon='phone' class='w-5 h-5 mr-3 text-[#0056B3]' %}
            <div>
              <span class="text-gray-600 text-sm">聯絡電話</span>
              <p class="text-gray-800 font-medium">{{ merchant.Cellphone }}</p>
            </div>
          </div>
          
          <div class="flex items-center">
            {% include 'components/icons.html' with icon='email' class='w-5 h-5 mr-3 text-[#0056B3]' %}
            <div>
              <span class="text-gray-600 text-sm">Email</span>
              <p class="text-gray-800 font-medium">{{ merchant.Email }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 商品列表區塊 -->
    <div class="mb-6">
      <h2 class="text-3xl font-bold text-gray-800 mb-8">商品列表</h2>

      {% if products %}
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
          {% for product in products %}
          <div class="bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300">
            <!-- 商品圖片 -->
            <div class="h-64 bg-gray-200 relative">
              {% if product.image %}
                <img src="{{ product.image.url }}" alt="{{ product.name }}" class="w-full h-full object-cover">
              {% else %}
                <div class="w-full h-full flex items-center justify-center text-gray-400">
                  <div class="text-center">
                    {% include 'components/icons.html' with icon='image-placeholder' class='w-16 h-16 mx-auto mb-2' %}
                    <span class="text-sm">無圖片</span>
                  </div>
                </div>
              {% endif %}
            </div>

            <!-- 商品資訊 -->
            <div class="p-6">
              <h3 class="text-xl font-bold text-gray-800 mb-2">{{ product.name }}</h3>
              
              {% if product.description %}
                <p class="text-gray-600 text-sm mb-4 line-clamp-2">{{ product.description|truncatechars:80 }}</p>
              {% endif %}
              
              <div class="flex items-center justify-between mb-4">
                <p class="text-3xl font-bold text-[#0056B3]">NT$ {{ product.price }}</p>
                <span class="text-xs text-gray-500">{{ product.created_at|date:"Y/m/d" }}</span>
              </div>

              <!-- 聯絡資訊 -->
              {% if product.phone_number %}
              <div class="flex items-center mb-4 text-sm text-gray-600">
                {% include 'components/icons.html' with icon='phone' class='w-4 h-4 mr-2' %}
                {{ product.phone_number }}
              </div>
              {% endif %}

              <!-- 購買按鈕 -->
              <div class="mt-6">
                 <a href="{% url 'public_store:payment_page_custom' id=product.id %}"
                    class="w-full bg-[#0056B3] hover:bg-[#00408A] text-white font-medium py-3 px-6 rounded-lg transition duration-200 flex items-center justify-center group">
                    <span>立即購買</span>{% include 'components/icons.html' with icon='arrow-right' class='w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform' %}
                 </a>
              </div>
            </div>
          </div>
          {% endfor %}
        </div>
      {% else %}
        <!-- 空狀態 -->
        <div class="text-center py-16">
          <div class="bg-white rounded-lg shadow-lg p-12">
            {% include 'components/icons.html' with icon='empty-shop' class='w-24 h-24 mx-auto mb-6 text-gray-300' %}
            <h3 class="text-2xl font-bold text-gray-600 mb-4">此商家尚未上架任何商品</h3>
            <p class="text-gray-500">請稍後再來查看，或聯絡商家了解更多資訊</p>
          </div>
        </div>
      {% endif %}
    </div>

    <!-- 信任標章 -->
    <div class="mt-12 bg-white border border-gray-200 rounded-lg p-6">
      <div class="flex items-center justify-center space-x-8 text-sm text-gray-600">
        <div class="flex items-center">
          {% include 'components/icons.html' with icon='security' class='w-5 h-5 mr-2 text-green-500' %}
          安全加密
        </div>
        <div class="flex items-center">
          {% include 'components/icons.html' with icon='verified' class='w-5 h-5 mr-2 text-blue-500' %}
          TruePay 認證
        </div>
        <div class="flex items-center">
          {% include 'components/icons.html' with icon='phone' class='w-5 h-5 mr-2 text-purple-500' %}
          24小時客服
        </div>
      </div>
    </div>

  </div>
</div>
{% endblock %}